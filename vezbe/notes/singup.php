<?phpsession_start();if(!isset($conn)){    include "conn.php";}$missingUsername='<p><strong>Molimo vas unesite Username</strong></p>';$missingEmail='<p><strong>Molimo vas unesite E-mail</strong></p>';$invalidPassword='<p><strong>Vas password mora sadrzati najmanje 6 karaktera,i bar jedan broj i bar jedno veliko slovo</strong></p>';$missingPassword='<p><strong>MOlimo vas unesite password</strong></p>';$differentPassword='<p><strong>Passwordi se ne poklapaju</strong></p>';$missingPassword2='<p><strong>Molimo ponovite vas password</strong></p>';$invalidEmail='<p><strong>Ne vazeca email adresa</strong></p>';$errors='';if(empty($_POST['username'])){    $errors .=$missingUsername;}else{    $username= filter_var($_POST['username'],FILTER_SANITIZE_STRING);}if(empty($_POST['email'])){    $errors.=$missingEmail;}else{    $email= filter_var($_POST['email'],FILTER_SANITIZE_EMAIL);    if(!filter_var($email,FILTER_VALIDATE_EMAIL)){        $errors.=$invalidEmail;    }}if(empty($_POST["password"])){    $errors.=$missingPassword;}elseif(!(strlen($_POST['password'])>6 and preg_match('/[A-Z]/',$_POST['password'])and        preg_match('/[0-9]/',$_POST['password']))){    $errors.=$invalidPassword;}else{    $password= filter_var($_POST['password'],FILTER_SANITIZE_STRING);    if(empty($_POST['password2'])){        $errors.=$missingPassword2;    }else{        $password2= filter_var($_POST['password2'],FILTER_SANITIZE_STRING);      if($password !== $password2){          $errors.=$differentPassword;      }    }}if($errors){    $resultMessage = '<div class="alert alert-danger">'.$errors.'</div>';    echo $resultMessage;}else {    $username = mysqli_real_escape_string($conn, $username);    $email = mysqli_real_escape_string($conn, $email);    $password = mysqli_real_escape_string($conn, $password);    //$password=md5($password);    $password=hash('sha256',$password);    $sql = "SELECT * FROM users WHERE username = '$username'";    $res = mysqli_query($conn, $sql);    if (!$res) {        echo '<div class="alert alert-danger">Greska u upitu</div>';       echo '<div class="alert alert-danger">'.mysqli_error($conn).'</div>';        exit;    }    $res = mysqli_num_rows($res);    if ($res) {        echo '<div class="alert alert-danger">Username je zauzet</div>';        exit;    }    $sql = "SELECT * FROM users WHERE email = '$email'";    $res = mysqli_query($conn, $sql);    if(!$res){        echo '<div class="alert alert-danger">Greskass u upitu</div>';        exit;    }    $res=mysqli_num_rows($res);    if($res){        echo '<div class="alert alert-danger">Email je zauzet</div>'; exit;    }    $activationKey=bin2hex(openssl_random_pseudo_bytes(16));    $sql = "INSERT INTO users (`username`, `email`, `password`, `activation`) VALUES ('$username', '$email', '$password', '$activationKey')";    $result=mysqli_query($conn,$sql);    if(!$result){        echo '<div class="alert alert-danger">Greska u slanju podataka</div>';        echo mysqli_error($conn);        exit;    }    $message= "MOlim vas kliknite na link za aktivaciju accounta:\n\n";    $message.= "http://vsp-dev.thecompletewebhosting.com/notes/activate.php?email=".urlencode($email)."&key=$activationKey";   if(mail($email,'confirm your registration',$message,'From:'.'vukasin123@gmail.com')){        echo '<div class="alert alert-success">Hvala na registraciji, potvrdite email adresu klikom na link u mailu</div>';    }}